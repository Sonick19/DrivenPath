[0m22:33:20.120112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dcb3b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01ddb7bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dcd8cbf0>]}


============================== 22:33:20.166956 | faa68bd9-e3b8-43c1-8dbd-e9f42fb2d1b7 ==============================
[0m22:33:20.166956 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:33:20.168021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:33:20.414663 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('model-path' was unexpected)

Error encountered in /opt/airflow/dbt/dbt_project.yml
[0m22:33:20.416231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.78910017, "process_user_time": 4.377703, "process_kernel_time": 2.14021, "process_mem_max_rss": "110764", "process_in_blocks": "30904", "process_out_blocks": "4056", "command_success": false}
[0m22:33:20.417315 [debug] [MainThread]: Command `dbt run` failed at 22:33:20.417177 after 0.79 seconds
[0m22:33:20.418222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dcb234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dcce9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd2c1fd0>]}
[0m22:33:20.419117 [debug] [MainThread]: Flushing usage events
[0m22:54:20.396190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f5b9e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f6ccb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f454a900>]}


============================== 22:54:20.530073 | a15846e6-eea6-44a6-98fd-ff3c4eba2f32 ==============================
[0m22:54:20.530073 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:54:20.531314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m22:54:20.903029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a15846e6-eea6-44a6-98fd-ff3c4eba2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f41335f0>]}
[0m22:54:20.975749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a15846e6-eea6-44a6-98fd-ff3c4eba2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f453db50>]}
[0m22:54:21.023731 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:54:21.375836 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:54:21.380858 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:54:21.381770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a15846e6-eea6-44a6-98fd-ff3c4eba2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f4150080>]}
[0m22:54:21.572841 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m22:54:21.615585 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m22:54:21.617413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3132381, "process_user_time": 5.55049, "process_kernel_time": 6.414308, "process_mem_max_rss": "108168", "process_in_blocks": "616", "command_success": false, "process_out_blocks": "0"}
[0m22:54:21.618539 [debug] [MainThread]: Command `dbt run` failed at 22:54:21.618410 after 1.31 seconds
[0m22:54:21.619424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f496a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f3b0bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f50ed940>]}
[0m22:54:21.620296 [debug] [MainThread]: Flushing usage events
[0m23:10:54.041770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b586b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b39fe840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b30666c0>]}


============================== 23:10:54.150633 | 7a1250ba-6dda-404c-b2ac-122297af4ffb ==============================
[0m23:10:54.150633 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:10:54.151773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m23:10:55.198385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a1250ba-6dda-404c-b2ac-122297af4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b38a0a70>]}
[0m23:10:55.271011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a1250ba-6dda-404c-b2ac-122297af4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b2c97080>]}
[0m23:10:55.272563 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:10:55.392630 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:10:55.397366 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:10:55.398176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a1250ba-6dda-404c-b2ac-122297af4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b1d17f50>]}
[0m23:10:55.501023 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m23:10:55.503567 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m23:10:55.505115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5398309, "process_user_time": 3.728498, "process_kernel_time": 1.292187, "process_mem_max_rss": "108244", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:10:55.506102 [debug] [MainThread]: Command `dbt run` failed at 23:10:55.505968 after 1.54 seconds
[0m23:10:55.507006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b586b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b1d27e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b1d27bf0>]}
[0m23:10:55.508009 [debug] [MainThread]: Flushing usage events
[0m23:13:30.632069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3c418a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3c79e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3c0201a0>]}


============================== 23:13:30.639059 | 8531bc94-3d5a-482f-88dd-709c84bb7983 ==============================
[0m23:13:30.639059 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:13:30.640374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:13:30.913285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8531bc94-3d5a-482f-88dd-709c84bb7983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3cf3aea0>]}
[0m23:13:31.004365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8531bc94-3d5a-482f-88dd-709c84bb7983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3d5f4b60>]}
[0m23:13:31.005745 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:13:31.160005 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:13:31.162933 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:13:31.163704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8531bc94-3d5a-482f-88dd-709c84bb7983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3e63ae70>]}
[0m23:13:31.188365 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m23:13:31.192825 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m23:13:31.195642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.64305425, "process_user_time": 2.876335, "process_kernel_time": 0.545708, "process_mem_max_rss": "108332", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:13:31.197079 [debug] [MainThread]: Command `dbt run` failed at 23:13:31.196810 after 0.64 seconds
[0m23:13:31.198261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3c066b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3d74e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3bc50620>]}
[0m23:13:31.199228 [debug] [MainThread]: Flushing usage events
[0m23:22:44.686932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9db09790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9db08ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9dc49490>]}


============================== 23:22:44.736276 | e1186808-edfa-46ac-b23a-d5db0b4bc4d0 ==============================
[0m23:22:44.736276 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:22:44.737582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:22:45.050292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1186808-edfa-46ac-b23a-d5db0b4bc4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9e249430>]}
[0m23:22:45.122899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1186808-edfa-46ac-b23a-d5db0b4bc4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9d319910>]}
[0m23:22:45.124355 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:22:45.243578 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:22:45.248334 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:22:45.249275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1186808-edfa-46ac-b23a-d5db0b4bc4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9c7bba40>]}
[0m23:22:45.386932 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m23:22:45.389755 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m23:22:45.391637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8335601, "process_user_time": 3.541927, "process_kernel_time": 0.800213, "process_mem_max_rss": "108300", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:22:45.393088 [debug] [MainThread]: Command `dbt run` failed at 23:22:45.392879 after 0.84 seconds
[0m23:22:45.394161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9db09790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9d2e6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9c768140>]}
[0m23:22:45.395371 [debug] [MainThread]: Flushing usage events
[0m23:24:59.164483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be60f5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be50bbc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be2873e30>]}


============================== 23:24:59.172004 | ebfa3cd2-e0d3-46c5-b93b-1e6807010505 ==============================
[0m23:24:59.172004 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:24:59.173054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:24:59.737985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebfa3cd2-e0d3-46c5-b93b-1e6807010505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be3ddb770>]}
[0m23:24:59.807077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebfa3cd2-e0d3-46c5-b93b-1e6807010505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be4bedbe0>]}
[0m23:24:59.808424 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:24:59.968523 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:24:59.973398 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:24:59.974285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebfa3cd2-e0d3-46c5-b93b-1e6807010505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be1efb680>]}
[0m23:25:00.126788 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m23:25:00.129898 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m23:25:00.131896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0559176, "process_user_time": 3.500731, "process_kernel_time": 0.807861, "process_mem_max_rss": "108244", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:25:00.133149 [debug] [MainThread]: Command `dbt run` failed at 23:25:00.132972 after 1.06 seconds
[0m23:25:00.134192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be60f5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be3ad6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be29285c0>]}
[0m23:25:00.135483 [debug] [MainThread]: Flushing usage events
[0m23:28:28.218454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8104be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd80bc00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd818e6e70>]}


============================== 23:28:28.368003 | 24a65c1e-84f4-49b6-8237-0ae98e1755b5 ==============================
[0m23:28:28.368003 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:28:28.369208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:28:31.090725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24a65c1e-84f4-49b6-8237-0ae98e1755b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd820ef2f0>]}
[0m23:28:31.156917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24a65c1e-84f4-49b6-8237-0ae98e1755b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd80bc31d0>]}
[0m23:28:31.158195 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:28:31.362354 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:28:31.381827 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:28:31.382857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24a65c1e-84f4-49b6-8237-0ae98e1755b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd80c01400>]}
[0m23:28:31.443104 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m23:28:31.446349 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m23:28:31.448879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2995007, "process_user_time": 3.164765, "process_kernel_time": 2.266294, "process_mem_max_rss": "108376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:28:31.450248 [debug] [MainThread]: Command `dbt run` failed at 23:28:31.450032 after 3.30 seconds
[0m23:28:31.451281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd814c60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd80c59be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd807c5760>]}
[0m23:28:31.452547 [debug] [MainThread]: Flushing usage events
[0m15:20:42.862616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e79f9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e56b26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e56b2810>]}


============================== 15:20:42.909483 | 6d190297-cca5-45e5-a10e-f8d7d9460483 ==============================
[0m15:20:42.909483 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:20:42.911176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:43.943267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d190297-cca5-45e5-a10e-f8d7d9460483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e52e43b0>]}
[0m15:20:44.013301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d190297-cca5-45e5-a10e-f8d7d9460483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e65f1d00>]}
[0m15:20:44.015279 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:20:44.238946 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:20:44.426978 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:20:44.428030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d190297-cca5-45e5-a10e-f8d7d9460483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e52e69c0>]}
[0m15:20:44.654780 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m15:20:44.716779 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m15:20:44.790445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0309935, "process_user_time": 2.787229, "process_kernel_time": 0.345784, "process_mem_max_rss": "111368", "process_in_blocks": "34768", "command_success": false, "process_out_blocks": "0"}
[0m15:20:44.791959 [debug] [MainThread]: Command `dbt run` failed at 15:20:44.791744 after 2.03 seconds
[0m15:20:44.792928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e90f5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e5eb40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4b13860>]}
[0m15:20:44.793773 [debug] [MainThread]: Flushing usage events
[0m15:23:03.000949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8eca6cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ec8e4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ec1db9b0>]}


============================== 15:23:03.025995 | 1624e88e-8873-4d3b-bc49-a7da2dde40b5 ==============================
[0m15:23:03.025995 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:23:03.027224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:03.289188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1624e88e-8873-4d3b-bc49-a7da2dde40b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebde2060>]}
[0m15:23:03.369069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1624e88e-8873-4d3b-bc49-a7da2dde40b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8eca9a540>]}
[0m15:23:03.370667 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:23:03.489213 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:23:03.675799 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:23:03.677038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1624e88e-8873-4d3b-bc49-a7da2dde40b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8eca6c080>]}
[0m15:23:03.713573 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m15:23:03.717716 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m15:23:03.722733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8005697, "process_user_time": 2.646333, "process_kernel_time": 0.159177, "process_mem_max_rss": "111528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:23:03.724244 [debug] [MainThread]: Command `dbt run` failed at 15:23:03.724020 after 0.80 seconds
[0m15:23:03.725259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ec8e4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ec23d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebebc710>]}
[0m15:23:03.726080 [debug] [MainThread]: Flushing usage events
[0m15:24:12.613193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6231ad1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6232152060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62315f39b0>]}


============================== 15:24:12.620253 | 6e9bf11e-5e00-4f71-948b-65fdcd453a88 ==============================
[0m15:24:12.620253 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:24:12.621218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:24:12.880876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e9bf11e-5e00-4f71-948b-65fdcd453a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f623101f140>]}
[0m15:24:12.958215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e9bf11e-5e00-4f71-948b-65fdcd453a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62313a43e0>]}
[0m15:24:12.959612 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:24:13.079302 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:24:13.218238 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:24:13.219519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e9bf11e-5e00-4f71-948b-65fdcd453a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6231bdbf20>]}
[0m15:24:13.248282 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
[0m15:24:13.250691 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

[0m15:24:13.442404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9025346, "process_user_time": 2.973881, "process_kernel_time": 0.130609, "process_mem_max_rss": "111416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:24:13.443617 [debug] [MainThread]: Command `dbt run` failed at 15:24:13.443397 after 0.90 seconds
[0m15:24:13.444447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6231717170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62316b8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6231f8ac30>]}
[0m15:24:13.445279 [debug] [MainThread]: Flushing usage events
[0m15:25:55.592366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a54726f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a5c2f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a54710a0>]}


============================== 15:25:55.598972 | cf01de53-b516-48ae-9400-6fd23a4c2724 ==============================
[0m15:25:55.598972 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:25:55.600343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:55.829384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a54b8260>]}
[0m15:25:55.906285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a53fbf50>]}
[0m15:25:55.907735 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:25:56.046611 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:25:56.164657 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:25:56.165535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a5c940b0>]}
[0m15:25:58.183820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a3bc03e0>]}
[0m15:25:58.488660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a3711280>]}
[0m15:25:58.489738 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m15:25:58.490644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a3b40dd0>]}
[0m15:25:58.493394 [info ] [MainThread]: 
[0m15:25:58.494597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:25:58.500887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:25:58.702602 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:25:58.703576 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:25:58.704512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:58.709691 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m15:25:58.711740 [debug] [ThreadPool]: On list_airflow: Close
[0m15:25:58.715137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m15:25:58.723073 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:25:58.723938 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m15:25:58.724687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:58.731741 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:25:58.732715 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:25:58.733696 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m15:25:58.869334 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.135 seconds
[0m15:25:58.871482 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m15:25:58.872591 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m15:25:58.873716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m15:25:58.877956 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:25:58.878779 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m15:25:58.879550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:58.884411 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:25:58.885751 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:25:58.886871 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m15:25:58.890471 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m15:25:58.892610 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m15:25:58.893645 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m15:25:58.902747 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:58.903640 [debug] [MainThread]: On master: BEGIN
[0m15:25:58.904416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:58.909364 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:25:58.910821 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:58.912287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:25:58.962329 [debug] [MainThread]: SQL status: SELECT 0 in 0.049 seconds
[0m15:25:58.964821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a54a6720>]}
[0m15:25:58.965889 [debug] [MainThread]: On master: ROLLBACK
[0m15:25:58.966908 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:58.967705 [debug] [MainThread]: On master: BEGIN
[0m15:25:58.968918 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:25:58.969880 [debug] [MainThread]: On master: COMMIT
[0m15:25:58.971241 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:58.972275 [debug] [MainThread]: On master: COMMIT
[0m15:25:58.973427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:25:58.974369 [debug] [MainThread]: On master: Close
[0m15:25:58.975392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:58.976168 [info ] [MainThread]: 
[0m15:25:58.986193 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m15:25:58.987263 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m15:25:58.988303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.staging_dim_address)
[0m15:25:58.989095 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m15:25:58.999669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m15:25:59.175800 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m15:25:59.237486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m15:25:59.293542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:25:59.294330 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m15:25:59.295007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:59.299771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:25:59.300840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:25:59.301726 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:00.140129 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 0.808 seconds
[0m15:26:00.151078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:26:00.152336 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m15:26:00.156143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:26:00.161012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:26:00.162383 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m15:26:00.164452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:26:00.198939 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m15:26:00.200153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:26:00.200999 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m15:26:00.274922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.073 seconds
[0m15:26:00.283895 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m15:26:00.317586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:26:00.318567 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m15:26:00.515645 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.196 seconds
[0m15:26:00.518904 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m15:26:00.520837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a6961ca0>]}
[0m15:26:00.522006 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 131012[0m in 1.53s]
[0m15:26:00.523312 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m15:26:00.524217 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m15:26:00.525177 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m15:26:00.526136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m15:26:00.526941 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m15:26:00.532179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.563280 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m15:26:00.568779 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.576649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.577409 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m15:26:00.578129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:00.583835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:26:00.585267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.586460 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:00.845329 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 0.258 seconds
[0m15:26:00.850220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.851098 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m15:26:00.852380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:00.856216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.857033 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:26:00.858145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:00.861278 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m15:26:00.862498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.863835 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m15:26:00.907891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m15:26:00.911797 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m15:26:00.913522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:26:00.914395 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m15:26:00.956367 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m15:26:00.958516 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m15:26:00.959531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a12985c0>]}
[0m15:26:00.960610 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 131012[0m in 0.43s]
[0m15:26:00.962033 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m15:26:00.963400 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m15:26:00.964414 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m15:26:00.965367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m15:26:00.966179 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m15:26:00.970603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m15:26:00.996877 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m15:26:01.004084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m15:26:01.012116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:26:01.013332 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m15:26:01.014046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:01.018406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:26:01.019876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:26:01.021167 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:01.400114 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 0.378 seconds
[0m15:26:01.404705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:26:01.405597 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m15:26:01.406817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:01.410706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:26:01.411689 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m15:26:01.413380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:01.416112 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m15:26:01.417076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:26:01.417895 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m15:26:01.451773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m15:26:01.455490 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m15:26:01.456831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:26:01.457663 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m15:26:01.488071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m15:26:01.490242 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m15:26:01.491256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a12dc740>]}
[0m15:26:01.492404 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 131012[0m in 0.53s]
[0m15:26:01.493734 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m15:26:01.494706 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m15:26:01.496299 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m15:26:01.497470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m15:26:01.498411 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m15:26:01.503100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m15:26:01.510899 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m15:26:01.516569 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m15:26:01.523796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:26:01.524605 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m15:26:01.525289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:01.530520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:26:01.531909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:26:01.533148 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:02.218899 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 0.685 seconds
[0m15:26:02.223472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:26:02.224331 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m15:26:02.225531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:02.230493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:26:02.231445 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m15:26:02.232759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:02.235383 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m15:26:02.236180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:26:02.236980 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m15:26:02.286443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m15:26:02.290043 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m15:26:02.291601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:26:02.292424 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m15:26:02.332680 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m15:26:02.334701 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m15:26:02.335644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a3386de0>]}
[0m15:26:02.336646 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 131012[0m in 0.84s]
[0m15:26:02.337947 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m15:26:02.338910 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m15:26:02.339800 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m15:26:02.340695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m15:26:02.341465 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m15:26:02.346337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.372995 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m15:26:02.379097 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.386248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.386987 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m15:26:02.387615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:02.391561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:26:02.392979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.394032 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:02.685887 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 0.290 seconds
[0m15:26:02.690098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.690876 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m15:26:02.692091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:02.698182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.699043 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m15:26:02.700264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:02.703194 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m15:26:02.703981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.704729 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m15:26:02.793106 [debug] [Thread-1 (]: SQL status: COMMIT in 0.088 seconds
[0m15:26:02.797227 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m15:26:02.798615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m15:26:02.799415 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m15:26:02.828501 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m15:26:02.830706 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m15:26:02.832222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf01de53-b516-48ae-9400-6fd23a4c2724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a1269bb0>]}
[0m15:26:02.833993 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 131012[0m in 0.49s]
[0m15:26:02.835762 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m15:26:02.838431 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:02.839547 [debug] [MainThread]: On master: BEGIN
[0m15:26:02.840491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:02.846240 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:26:02.847779 [debug] [MainThread]: On master: COMMIT
[0m15:26:02.848817 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:02.849726 [debug] [MainThread]: On master: COMMIT
[0m15:26:02.851118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:02.852177 [debug] [MainThread]: On master: Close
[0m15:26:02.853297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:02.854100 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m15:26:02.855052 [info ] [MainThread]: 
[0m15:26:02.855937 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m15:26:02.858252 [debug] [MainThread]: Command end result
[0m15:26:02.941252 [info ] [MainThread]: 
[0m15:26:02.942391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:02.943228 [info ] [MainThread]: 
[0m15:26:02.944471 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:26:02.946032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4261627, "process_user_time": 5.212709, "process_kernel_time": 0.18865, "process_mem_max_rss": "127272", "process_in_blocks": "3840", "process_out_blocks": "0"}
[0m15:26:02.947109 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:02.946972 after 7.43 seconds
[0m15:26:02.947998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a3b7fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a56cf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a56ceb70>]}
[0m15:26:02.948880 [debug] [MainThread]: Flushing usage events
[0m15:26:08.677451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777189f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776e4bf740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776e4bfec0>]}


============================== 15:26:08.684104 | 765b7452-d7a4-45ee-b4ca-307bddbc70c0 ==============================
[0m15:26:08.684104 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:26:08.685168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m15:26:08.915063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776ebb2d80>]}
[0m15:26:08.985182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776d7ba720>]}
[0m15:26:08.986475 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:26:09.098005 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:26:09.307870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:09.308824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:09.354017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776d7e9610>]}
[0m15:26:09.541728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776e456f00>]}
[0m15:26:09.542871 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m15:26:09.543858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776e487f20>]}
[0m15:26:09.546627 [info ] [MainThread]: 
[0m15:26:09.548037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:09.554414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:26:09.601029 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:26:09.601894 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:26:09.602615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:09.608081 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m15:26:09.610035 [debug] [ThreadPool]: On list_airflow: Close
[0m15:26:09.612703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m15:26:09.620980 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:26:09.622186 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m15:26:09.623075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:09.627193 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:26:09.628065 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:26:09.628984 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m15:26:09.632299 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:26:09.634287 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m15:26:09.635255 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m15:26:09.636794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m15:26:09.641247 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:26:09.642116 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m15:26:09.642858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:09.646841 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:26:09.647777 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:26:09.648610 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m15:26:09.651968 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m15:26:09.653916 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m15:26:09.654891 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m15:26:09.662981 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:09.663853 [debug] [MainThread]: On master: BEGIN
[0m15:26:09.664594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:09.668690 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:26:09.669654 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:09.670758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:09.674915 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:26:09.677100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776cf9da30>]}
[0m15:26:09.678060 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:09.679050 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:09.679830 [debug] [MainThread]: On master: BEGIN
[0m15:26:09.681030 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:26:09.681844 [debug] [MainThread]: On master: COMMIT
[0m15:26:09.682668 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:09.683483 [debug] [MainThread]: On master: COMMIT
[0m15:26:09.684442 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:09.685214 [debug] [MainThread]: On master: Close
[0m15:26:09.686065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:09.686787 [info ] [MainThread]: 
[0m15:26:09.696316 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m15:26:09.697475 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m15:26:09.698465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.trusted_non_pii_data)
[0m15:26:09.699331 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m15:26:09.711430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:09.719817 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m15:26:09.774539 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:09.812114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:09.813051 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m15:26:09.813889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:09.818112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:26:09.819182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:09.820217 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:16.871964 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 7.029 seconds
[0m15:26:16.880219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:16.881195 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m15:26:16.883064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:26:16.887455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:16.888307 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m15:26:16.889531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:16.915917 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m15:26:16.917062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:16.917896 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m15:26:17.036762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.118 seconds
[0m15:26:17.046109 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m15:26:17.054406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:26:17.055420 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m15:26:17.145218 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.089 seconds
[0m15:26:17.148533 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m15:26:17.151062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f18a360>]}
[0m15:26:17.152294 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 131012[0m in 7.45s]
[0m15:26:17.153494 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m15:26:17.154407 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m15:26:17.155401 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m15:26:17.156438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m15:26:17.157281 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m15:26:17.162018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m15:26:17.170021 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m15:26:17.175724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m15:26:17.183114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:26:17.184388 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m15:26:17.185470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:17.190528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:26:17.191867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:26:17.192795 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:18.576624 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 1.384 seconds
[0m15:26:18.581705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:26:18.582752 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m15:26:18.584059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:18.588581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:26:18.589681 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m15:26:18.590973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:26:18.593899 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m15:26:18.594781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:26:18.595620 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m15:26:18.750492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.154 seconds
[0m15:26:18.754205 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m15:26:18.755594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:26:18.756459 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m15:26:18.824053 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.067 seconds
[0m15:26:18.827229 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m15:26:18.828732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776abf4890>]}
[0m15:26:18.830471 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 131012[0m in 1.67s]
[0m15:26:18.831914 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m15:26:18.832964 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m15:26:18.833902 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m15:26:18.835030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m15:26:18.836181 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m15:26:18.842693 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m15:26:18.851173 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m15:26:18.857908 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m15:26:18.866382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:26:18.867180 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m15:26:18.867892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:18.871724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:26:18.872852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:26:18.873930 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:22.753274 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 3.878 seconds
[0m15:26:22.759226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:26:22.760631 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m15:26:22.762609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:26:22.768157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:26:22.769300 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m15:26:22.770847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:26:22.775009 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m15:26:22.776394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:26:22.777822 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m15:26:22.937145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.158 seconds
[0m15:26:22.941315 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m15:26:22.943206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:26:22.944307 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m15:26:22.973780 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m15:26:22.976418 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m15:26:22.977992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77692231a0>]}
[0m15:26:22.979236 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 131012[0m in 4.14s]
[0m15:26:22.980688 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m15:26:22.981824 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m15:26:22.982854 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m15:26:22.983864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m15:26:22.984763 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m15:26:22.989898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m15:26:23.000453 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m15:26:23.006300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m15:26:23.015247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:26:23.016125 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m15:26:23.016883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:23.021595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:26:23.023009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:26:23.024065 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:26:24.849679 [debug] [Thread-1 (]: SQL status: SELECT 131012 in 1.824 seconds
[0m15:26:24.854289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:26:24.855223 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m15:26:24.857043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:26:24.864415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:26:24.865512 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m15:26:24.867010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:26:24.871017 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m15:26:24.872791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:26:24.873712 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m15:26:24.918727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m15:26:24.922563 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m15:26:24.924193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:26:24.925511 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m15:26:24.969030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.043 seconds
[0m15:26:24.971262 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m15:26:24.972365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765b7452-d7a4-45ee-b4ca-307bddbc70c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776ab8be00>]}
[0m15:26:24.973870 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 131012[0m in 1.99s]
[0m15:26:24.975957 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m15:26:24.979020 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:24.979933 [debug] [MainThread]: On master: BEGIN
[0m15:26:24.980874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:24.985823 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:26:24.987086 [debug] [MainThread]: On master: COMMIT
[0m15:26:24.987835 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:24.988693 [debug] [MainThread]: On master: COMMIT
[0m15:26:24.989765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:24.990989 [debug] [MainThread]: On master: Close
[0m15:26:24.992545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:24.993446 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m15:26:24.994576 [info ] [MainThread]: 
[0m15:26:24.995517 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.45 seconds (15.45s).
[0m15:26:24.997612 [debug] [MainThread]: Command end result
[0m15:26:25.079896 [info ] [MainThread]: 
[0m15:26:25.081479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:25.082532 [info ] [MainThread]: 
[0m15:26:25.083649 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:26:25.085596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.480421, "process_user_time": 3.253774, "process_kernel_time": 0.16864, "process_mem_max_rss": "121416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:26:25.087244 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:25.086981 after 16.48 seconds
[0m15:26:25.088676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77718c30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776c346a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769233500>]}
[0m15:26:25.090047 [debug] [MainThread]: Flushing usage events
[0m15:43:50.386494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4479306750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44790a6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4479b24d70>]}


============================== 15:43:50.421227 | 2aa9c29b-2417-4cbc-b69d-8a4f7016680d ==============================
[0m15:43:50.421227 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:43:50.422560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:50.671179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447a15f770>]}
[0m15:43:50.740527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44793ebe30>]}
[0m15:43:50.742176 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:43:50.864110 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:43:51.074655 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m15:43:51.076226 [debug] [MainThread]: Partial parsing: added file: dbt_driven_data://models/staging_dim_fact_network_usage.sql
[0m15:43:51.077149 [debug] [MainThread]: Partial parsing: deleted file: dbt_driven_data://models/staging_fact_network_usage.sql
[0m15:43:51.078073 [debug] [MainThread]: Partial parsing: updated file: dbt_driven_data://models/staging_dim_address.sql
[0m15:43:51.390959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4476face60>]}
[0m15:43:51.540782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4476fc0380>]}
[0m15:43:51.542586 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m15:43:51.544228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4479819df0>]}
[0m15:43:51.547315 [info ] [MainThread]: 
[0m15:43:51.548928 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:51.554562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:43:51.604228 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:43:51.605227 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:43:51.606023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:51.611644 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m15:43:51.613625 [debug] [ThreadPool]: On list_airflow: Close
[0m15:43:51.616226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m15:43:51.625418 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:43:51.626477 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m15:43:51.627209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:51.631342 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:43:51.632467 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:43:51.633364 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m15:43:51.637722 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m15:43:51.639865 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m15:43:51.640918 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m15:43:51.642436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m15:43:51.646554 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:43:51.647415 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m15:43:51.648165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:51.652213 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:43:51.653028 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:43:51.653955 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m15:43:51.657120 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:43:51.659470 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m15:43:51.660594 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m15:43:51.668558 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:51.669410 [debug] [MainThread]: On master: BEGIN
[0m15:43:51.670174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:51.674357 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:43:51.675771 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:51.676950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:51.681531 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:43:51.683691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44773ec140>]}
[0m15:43:51.684604 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:51.685484 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:51.686101 [debug] [MainThread]: On master: BEGIN
[0m15:43:51.687073 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:43:51.687830 [debug] [MainThread]: On master: COMMIT
[0m15:43:51.688452 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:51.689080 [debug] [MainThread]: On master: COMMIT
[0m15:43:51.689907 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:43:51.690541 [debug] [MainThread]: On master: Close
[0m15:43:51.691509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:51.692793 [info ] [MainThread]: 
[0m15:43:51.702806 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m15:43:51.703902 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m15:43:51.704871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.staging_dim_address)
[0m15:43:51.705791 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m15:43:51.716505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m15:43:51.725693 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m15:43:51.778295 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m15:43:51.786118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:43:51.786950 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m15:43:51.787654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:51.791793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:43:51.793205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:43:51.794126 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)
SELECT
    *
FROM
    source_data
  );
  
[0m15:43:53.107149 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 1.312 seconds
[0m15:43:53.116817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:43:53.117861 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m15:43:53.119346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:43:53.123701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:43:53.125085 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m15:43:53.126360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:43:53.154587 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m15:43:53.155720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:43:53.156500 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m15:43:53.210033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.052 seconds
[0m15:43:53.218268 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m15:43:53.225570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m15:43:53.226664 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m15:43:53.263003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m15:43:53.266298 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m15:43:53.268264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447a15e210>]}
[0m15:43:53.269337 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 137378[0m in 1.56s]
[0m15:43:53.270572 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m15:43:53.271926 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m15:43:53.272900 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m15:43:53.273943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m15:43:53.275085 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m15:43:53.279436 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m15:43:53.286076 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m15:43:53.293394 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m15:43:53.300405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:43:53.301206 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m15:43:53.302046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:53.306730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:43:53.308558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:43:53.309565 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:43:53.605700 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 0.295 seconds
[0m15:43:53.611288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:43:53.612406 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m15:43:53.613814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:43:53.619553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:43:53.620475 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:43:53.621708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:43:53.625370 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m15:43:53.626297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:43:53.627107 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m15:43:54.053739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.426 seconds
[0m15:43:54.057996 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m15:43:54.059488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m15:43:54.060329 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m15:43:54.129420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.068 seconds
[0m15:43:54.131788 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m15:43:54.133046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4474933590>]}
[0m15:43:54.134363 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 137378[0m in 0.86s]
[0m15:43:54.135843 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m15:43:54.136892 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_fact_network_usage
[0m15:43:54.138161 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m15:43:54.139683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_fact_network_usage)
[0m15:43:54.141299 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_fact_network_usage
[0m15:43:54.146198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.187804 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_fact_network_usage
[0m15:43:54.194053 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.201460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.202394 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: BEGIN
[0m15:43:54.203150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:54.208119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:43:54.209196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.210195 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:43:54.622185 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 0.411 seconds
[0m15:43:54.627011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.628029 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m15:43:54.629565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:43:54.634131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.635023 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m15:43:54.636188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:43:54.639057 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: COMMIT
[0m15:43:54.640307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.641127 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: COMMIT
[0m15:43:54.841907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.200 seconds
[0m15:43:54.845498 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m15:43:54.846929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m15:43:54.847778 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m15:43:54.964663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.116 seconds
[0m15:43:54.968528 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: Close
[0m15:43:54.969870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4474ba1bb0>]}
[0m15:43:54.971187 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 137378[0m in 0.83s]
[0m15:43:54.973804 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_fact_network_usage
[0m15:43:54.975553 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m15:43:54.977093 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m15:43:54.978585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_fact_network_usage, now model.dbt_driven_data.staging_dim_finance)
[0m15:43:54.979810 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m15:43:54.986398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m15:43:54.994350 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m15:43:55.009330 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m15:43:55.017735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:43:55.018580 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m15:43:55.019293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:55.024394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:43:55.025847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:43:55.027176 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:43:55.342926 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 0.315 seconds
[0m15:43:55.348366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:43:55.349275 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m15:43:55.350572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:43:55.354766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:43:55.356069 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m15:43:55.506321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:43:55.509631 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m15:43:55.510599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:43:55.511452 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m15:43:55.590016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.078 seconds
[0m15:43:55.594044 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m15:43:55.595580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m15:43:55.596468 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m15:43:55.651941 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.055 seconds
[0m15:43:55.654098 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m15:43:55.655508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447497cb60>]}
[0m15:43:55.657116 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 137378[0m in 0.68s]
[0m15:43:55.658700 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m15:43:55.659659 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m15:43:55.660652 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m15:43:55.661671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m15:43:55.662519 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m15:43:55.666832 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m15:43:55.675025 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m15:43:55.680395 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m15:43:55.688879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:43:55.689950 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m15:43:55.690836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:55.695303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:43:55.696424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:43:55.697294 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:43:56.582511 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 0.884 seconds
[0m15:43:56.587616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:43:56.589520 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m15:43:56.591791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:43:56.601429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:43:56.603281 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m15:43:56.605443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:43:56.608484 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m15:43:56.609267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:43:56.610121 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m15:43:56.774211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.163 seconds
[0m15:43:56.777871 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m15:43:56.779357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m15:43:56.780186 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m15:43:56.889280 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.108 seconds
[0m15:43:56.891363 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m15:43:56.892539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa9c29b-2417-4cbc-b69d-8a4f7016680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447a038710>]}
[0m15:43:56.893616 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 137378[0m in 1.23s]
[0m15:43:56.894887 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m15:43:56.897047 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:56.898045 [debug] [MainThread]: On master: BEGIN
[0m15:43:56.898826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:56.903038 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:43:56.904725 [debug] [MainThread]: On master: COMMIT
[0m15:43:56.905984 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:56.906758 [debug] [MainThread]: On master: COMMIT
[0m15:43:56.908031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:43:56.909040 [debug] [MainThread]: On master: Close
[0m15:43:56.910267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:56.911163 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_dim_person' was properly closed.
[0m15:43:56.912346 [info ] [MainThread]: 
[0m15:43:56.913361 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m15:43:56.915950 [debug] [MainThread]: Command end result
[0m15:43:56.982413 [info ] [MainThread]: 
[0m15:43:56.983338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:56.984185 [info ] [MainThread]: 
[0m15:43:56.985019 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:43:56.986378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.694436, "process_user_time": 3.561317, "process_kernel_time": 0.350129, "process_mem_max_rss": "127644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:43:56.987691 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:56.987374 after 6.70 seconds
[0m15:43:56.988708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4478bfac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4478e964b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4477f9d2b0>]}
[0m15:43:56.989560 [debug] [MainThread]: Flushing usage events
[0m15:44:03.181747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13db4abbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13dd491df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13daf08bf0>]}


============================== 15:44:03.189410 | 8d8ecc3c-e236-4486-9e5c-46185bdedcc2 ==============================
[0m15:44:03.189410 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:44:03.190591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m15:44:03.433933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13da8fc710>]}
[0m15:44:03.507451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13dbb3e390>]}
[0m15:44:03.508883 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:44:03.639118 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:44:03.845538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:03.846573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:03.895697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9f6ade0>]}
[0m15:44:04.053885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9f01bb0>]}
[0m15:44:04.055103 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m15:44:04.056120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9753470>]}
[0m15:44:04.059428 [info ] [MainThread]: 
[0m15:44:04.060618 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:04.067730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:44:04.126447 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:44:04.127339 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:44:04.128088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:04.134360 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m15:44:04.136404 [debug] [ThreadPool]: On list_airflow: Close
[0m15:44:04.139159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m15:44:04.147384 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:44:04.148933 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m15:44:04.149974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:04.154478 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:44:04.155502 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m15:44:04.156466 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m15:44:04.159724 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m15:44:04.161781 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m15:44:04.162828 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m15:44:04.163925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m15:44:04.168774 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:44:04.169664 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m15:44:04.170438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:04.174567 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:44:04.175449 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m15:44:04.176299 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m15:44:04.180081 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m15:44:04.182988 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m15:44:04.184275 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m15:44:04.193025 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:04.194027 [debug] [MainThread]: On master: BEGIN
[0m15:44:04.194860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:04.199596 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:44:04.200457 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:04.201548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:04.205496 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:44:04.207641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d97a3fb0>]}
[0m15:44:04.208549 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:04.209533 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:04.210247 [debug] [MainThread]: On master: BEGIN
[0m15:44:04.211446 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:44:04.212225 [debug] [MainThread]: On master: COMMIT
[0m15:44:04.212986 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:04.213736 [debug] [MainThread]: On master: COMMIT
[0m15:44:04.214788 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:04.215738 [debug] [MainThread]: On master: Close
[0m15:44:04.216786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:04.217609 [info ] [MainThread]: 
[0m15:44:04.227340 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m15:44:04.228435 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m15:44:04.229451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.trusted_non_pii_data)
[0m15:44:04.230252 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m15:44:04.242505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:04.251136 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m15:44:04.309642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:04.319612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:04.320502 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m15:44:04.321382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:04.325678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:44:04.326732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:04.327799 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:44:06.879150 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 2.550 seconds
[0m15:44:06.887796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:06.888666 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m15:44:06.889972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:06.894013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:06.895118 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m15:44:06.896735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:44:06.923281 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m15:44:06.924292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:06.925169 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m15:44:07.078405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.152 seconds
[0m15:44:07.086975 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m15:44:07.093669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m15:44:07.094579 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m15:44:07.218554 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.123 seconds
[0m15:44:07.221994 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m15:44:07.224060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13dc171a00>]}
[0m15:44:07.225295 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 137378[0m in 2.99s]
[0m15:44:07.226529 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m15:44:07.227595 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m15:44:07.228876 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m15:44:07.230356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m15:44:07.231263 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m15:44:07.236129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m15:44:07.244775 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m15:44:07.250525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m15:44:07.259657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:44:07.260512 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m15:44:07.261429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:07.267458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:44:07.268675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:44:07.269704 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:44:08.650402 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 1.380 seconds
[0m15:44:08.654869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:44:08.655770 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m15:44:08.657028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:08.661427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:44:08.662648 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m15:44:08.663955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:08.666714 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m15:44:08.667560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:44:08.668433 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m15:44:08.934699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.265 seconds
[0m15:44:08.939161 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m15:44:08.940844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m15:44:08.941827 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m15:44:08.977048 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.034 seconds
[0m15:44:08.980024 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m15:44:08.981318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d62040b0>]}
[0m15:44:08.982514 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 137378[0m in 1.75s]
[0m15:44:08.983712 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m15:44:08.984791 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m15:44:08.985760 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m15:44:08.986801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m15:44:08.987715 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m15:44:08.993666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m15:44:09.002219 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m15:44:09.010976 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m15:44:09.020140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:44:09.021384 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m15:44:09.022496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:09.027416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:44:09.029346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:44:09.030671 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:44:11.002452 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 1.971 seconds
[0m15:44:11.006692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:44:11.007785 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m15:44:11.009538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:44:11.014027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:44:11.014921 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m15:44:11.016213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:11.019004 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m15:44:11.019846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:44:11.020703 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m15:44:11.057533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m15:44:11.062082 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m15:44:11.063606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m15:44:11.064487 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m15:44:11.101937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.037 seconds
[0m15:44:11.104118 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m15:44:11.105205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d7bcc740>]}
[0m15:44:11.106329 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 137378[0m in 2.12s]
[0m15:44:11.108234 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m15:44:11.109624 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m15:44:11.111216 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m15:44:11.112481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m15:44:11.113404 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m15:44:11.118273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m15:44:11.126655 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m15:44:11.131969 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m15:44:11.140323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:44:11.141160 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m15:44:11.142067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:11.146885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:44:11.148013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:44:11.148960 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:44:12.320714 [debug] [Thread-1 (]: SQL status: SELECT 137378 in 1.171 seconds
[0m15:44:12.325450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:44:12.326458 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m15:44:12.327738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:12.331953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:44:12.332815 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m15:44:12.333962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:12.336547 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m15:44:12.337378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:44:12.338236 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m15:44:12.439379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.100 seconds
[0m15:44:12.443669 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m15:44:12.445144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m15:44:12.445999 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m15:44:12.478917 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m15:44:12.481039 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m15:44:12.482042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8ecc3c-e236-4486-9e5c-46185bdedcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d87d5d30>]}
[0m15:44:12.483152 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 137378[0m in 1.37s]
[0m15:44:12.484632 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m15:44:12.486767 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:12.487559 [debug] [MainThread]: On master: BEGIN
[0m15:44:12.488331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:12.493117 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:44:12.494416 [debug] [MainThread]: On master: COMMIT
[0m15:44:12.495139 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:12.495849 [debug] [MainThread]: On master: COMMIT
[0m15:44:12.496743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:12.497402 [debug] [MainThread]: On master: Close
[0m15:44:12.498270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:12.499017 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m15:44:12.499988 [info ] [MainThread]: 
[0m15:44:12.500820 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m15:44:12.502815 [debug] [MainThread]: Command end result
[0m15:44:12.568199 [info ] [MainThread]: 
[0m15:44:12.569155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:12.570120 [info ] [MainThread]: 
[0m15:44:12.571184 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:44:12.572960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.461147, "process_user_time": 3.3076, "process_kernel_time": 0.217865, "process_mem_max_rss": "121428", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:44:12.573985 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:12.573815 after 9.46 seconds
[0m15:44:12.575209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13db4a8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13db301730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d7b86a50>]}
[0m15:44:12.576187 [debug] [MainThread]: Flushing usage events
[0m16:11:19.705679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac872d6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8743ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac87b13a10>]}


============================== 16:11:19.721005 | dd435f66-9fc8-448f-84bc-e13e577682c1 ==============================
[0m16:11:19.721005 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:11:19.722135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:20.037489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac87d1de20>]}
[0m16:11:20.122221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac86f51520>]}
[0m16:11:20.123718 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:11:20.288508 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:11:20.761821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:20.763900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:20.813842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac863552e0>]}
[0m16:11:20.983877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac85728c80>]}
[0m16:11:20.984958 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m16:11:20.985829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac85fb3f20>]}
[0m16:11:20.988803 [info ] [MainThread]: 
[0m16:11:20.989983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:20.996109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:11:21.078522 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:11:21.079409 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:11:21.080134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:21.085301 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m16:11:21.087617 [debug] [ThreadPool]: On list_airflow: Close
[0m16:11:21.092111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m16:11:21.101265 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:11:21.102143 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m16:11:21.102848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:21.107423 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:11:21.108347 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:11:21.109223 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m16:11:21.120357 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m16:11:21.122398 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m16:11:21.123261 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m16:11:21.124351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m16:11:21.129287 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:11:21.130132 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m16:11:21.130745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:21.134807 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:11:21.135584 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:11:21.136467 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m16:11:21.139634 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m16:11:21.141854 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m16:11:21.142881 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m16:11:21.151090 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.152201 [debug] [MainThread]: On master: BEGIN
[0m16:11:21.153030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:21.158383 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:11:21.159685 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.161044 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:21.167746 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m16:11:21.169883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8675c830>]}
[0m16:11:21.170784 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:21.171887 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.172699 [debug] [MainThread]: On master: BEGIN
[0m16:11:21.174037 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:11:21.174886 [debug] [MainThread]: On master: COMMIT
[0m16:11:21.175724 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.176469 [debug] [MainThread]: On master: COMMIT
[0m16:11:21.177481 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:21.178302 [debug] [MainThread]: On master: Close
[0m16:11:21.179545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:21.180558 [info ] [MainThread]: 
[0m16:11:21.190763 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m16:11:21.192010 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m16:11:21.193008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.staging_dim_address)
[0m16:11:21.193847 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m16:11:21.204266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m16:11:21.230456 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m16:11:21.287913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m16:11:21.388118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:11:21.389396 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m16:11:21.390430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:21.394739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:11:21.395829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:11:21.396890 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)
SELECT
    *
FROM
    source_data
  );
  
[0m16:11:23.523346 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 2.126 seconds
[0m16:11:23.531753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:11:23.532694 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m16:11:23.534163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:23.539140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:11:23.540035 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m16:11:23.541403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:23.575954 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m16:11:23.577089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:11:23.578177 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m16:11:23.702328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.123 seconds
[0m16:11:23.711655 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m16:11:23.718559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:11:23.719440 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m16:11:23.767046 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.047 seconds
[0m16:11:23.770462 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m16:11:23.773355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac863286e0>]}
[0m16:11:23.774655 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 144391[0m in 2.58s]
[0m16:11:23.775909 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m16:11:23.776849 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m16:11:23.777727 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m16:11:23.778580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m16:11:23.779383 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m16:11:23.783849 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m16:11:23.818291 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m16:11:23.823592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m16:11:23.831259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:11:23.832134 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m16:11:23.832845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:23.836887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:11:23.838185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:11:23.839244 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:24.599000 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 0.758 seconds
[0m16:11:24.604082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:11:24.605050 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m16:11:24.606423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:24.610841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:11:24.611760 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:11:24.613059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:24.615899 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m16:11:24.616790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:11:24.617603 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m16:11:24.729836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.111 seconds
[0m16:11:24.733715 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m16:11:24.735180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:11:24.735981 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m16:11:24.777128 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.040 seconds
[0m16:11:24.779477 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m16:11:24.780600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8438e150>]}
[0m16:11:24.781751 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 144391[0m in 1.00s]
[0m16:11:24.782995 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m16:11:24.783972 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:11:24.784988 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m16:11:24.785937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_fact_network_usage)
[0m16:11:24.786857 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:11:24.791432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:24.818435 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:11:24.825995 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:24.835727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:24.836910 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: BEGIN
[0m16:11:24.837724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:24.842171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:11:24.843536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:24.844509 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:26.084261 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 1.239 seconds
[0m16:11:26.088745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:26.089828 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m16:11:26.111606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:26.118007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:26.119215 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m16:11:26.121428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:26.127044 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: COMMIT
[0m16:11:26.128018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:26.128902 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: COMMIT
[0m16:11:26.236165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.106 seconds
[0m16:11:26.240120 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m16:11:26.242082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:11:26.242954 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m16:11:26.290272 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.046 seconds
[0m16:11:26.292926 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: Close
[0m16:11:26.294142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac842dc4d0>]}
[0m16:11:26.295524 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 144391[0m in 1.51s]
[0m16:11:26.297043 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:11:26.298091 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m16:11:26.299166 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m16:11:26.300234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_fact_network_usage, now model.dbt_driven_data.staging_dim_finance)
[0m16:11:26.301120 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m16:11:26.307018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m16:11:26.315988 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m16:11:26.327809 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m16:11:26.335751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:11:26.337099 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m16:11:26.338114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:26.343019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:11:26.344312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:11:26.345292 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:27.416605 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 1.070 seconds
[0m16:11:27.422168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:11:27.423524 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m16:11:27.426001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:27.432548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:11:27.433475 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m16:11:27.434898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:27.438880 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m16:11:27.440026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:11:27.440784 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m16:11:27.612612 [debug] [Thread-1 (]: SQL status: COMMIT in 0.171 seconds
[0m16:11:27.616844 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m16:11:27.618323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:11:27.619300 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m16:11:27.680775 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.061 seconds
[0m16:11:27.682856 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m16:11:27.683809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac842b3f20>]}
[0m16:11:27.684859 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 144391[0m in 1.38s]
[0m16:11:27.686627 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m16:11:27.687736 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m16:11:27.688794 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m16:11:27.689742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m16:11:27.690777 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m16:11:27.696890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m16:11:27.722835 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m16:11:27.730605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m16:11:27.741041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:11:27.742092 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m16:11:27.742924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:27.748253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:11:27.749693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:11:27.750782 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:29.894724 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 2.143 seconds
[0m16:11:29.900396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:11:29.901373 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m16:11:29.902749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:29.907056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:11:29.908078 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m16:11:29.909504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:29.912298 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m16:11:29.913147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:11:29.913962 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m16:11:30.042241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.127 seconds
[0m16:11:30.046063 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m16:11:30.047476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:11:30.048330 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m16:11:30.088779 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m16:11:30.091026 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m16:11:30.092117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd435f66-9fc8-448f-84bc-e13e577682c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8423dfa0>]}
[0m16:11:30.093318 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 144391[0m in 2.40s]
[0m16:11:30.094551 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m16:11:30.097025 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:30.097932 [debug] [MainThread]: On master: BEGIN
[0m16:11:30.098746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:30.110220 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:11:30.111250 [debug] [MainThread]: On master: COMMIT
[0m16:11:30.112193 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:30.112907 [debug] [MainThread]: On master: COMMIT
[0m16:11:30.113911 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:30.114629 [debug] [MainThread]: On master: Close
[0m16:11:30.115670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:30.116502 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_dim_person' was properly closed.
[0m16:11:30.117435 [info ] [MainThread]: 
[0m16:11:30.118243 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m16:11:30.120316 [debug] [MainThread]: Command end result
[0m16:11:30.188220 [info ] [MainThread]: 
[0m16:11:30.189261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:30.190120 [info ] [MainThread]: 
[0m16:11:30.190894 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:11:30.192224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.563707, "process_user_time": 3.914762, "process_kernel_time": 0.802526, "process_mem_max_rss": "123040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:11:30.193191 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:30.193055 after 10.56 seconds
[0m16:11:30.193976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac86354fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac87323d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac87323e00>]}
[0m16:11:30.194720 [debug] [MainThread]: Flushing usage events
[0m16:11:36.526937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad9cfa690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad9ff7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad9ff71d0>]}


============================== 16:11:36.533900 | 87aa5807-1d22-4d0b-b257-73d0a0e9d8e8 ==============================
[0m16:11:36.533900 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:11:36.534885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:11:36.777526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad913c680>]}
[0m16:11:36.853023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad9ff7860>]}
[0m16:11:36.854686 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:11:36.976358 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:11:37.184701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:37.186113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:37.232938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad8d408f0>]}
[0m16:11:37.397367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad8128b90>]}
[0m16:11:37.398620 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m16:11:37.399696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad8d419a0>]}
[0m16:11:37.404045 [info ] [MainThread]: 
[0m16:11:37.406604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:37.420208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:11:37.483389 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:11:37.484324 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:11:37.485175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:37.490462 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m16:11:37.494531 [debug] [ThreadPool]: On list_airflow: Close
[0m16:11:37.499674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m16:11:37.508283 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:11:37.509035 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m16:11:37.509672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:37.513409 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:11:37.514358 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:11:37.515360 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m16:11:37.519880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:11:37.522548 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m16:11:37.523825 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m16:11:37.525406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m16:11:37.530505 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:11:37.531346 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m16:11:37.532074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:37.536231 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:11:37.537405 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:11:37.538103 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m16:11:37.541288 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:11:37.543226 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m16:11:37.544011 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m16:11:37.552451 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.553307 [debug] [MainThread]: On master: BEGIN
[0m16:11:37.553930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:37.558061 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:11:37.559074 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.559973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:37.564044 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:11:37.566105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad8d23770>]}
[0m16:11:37.567154 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:37.568128 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.568824 [debug] [MainThread]: On master: BEGIN
[0m16:11:37.569763 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:11:37.570778 [debug] [MainThread]: On master: COMMIT
[0m16:11:37.571444 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.572309 [debug] [MainThread]: On master: COMMIT
[0m16:11:37.573215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:37.573893 [debug] [MainThread]: On master: Close
[0m16:11:37.574787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:37.575684 [info ] [MainThread]: 
[0m16:11:37.587746 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m16:11:37.588985 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m16:11:37.589990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.trusted_non_pii_data)
[0m16:11:37.590718 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m16:11:37.603928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:37.611476 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m16:11:37.665918 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:37.891954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:37.893188 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m16:11:37.894056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:37.898385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:11:37.899422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:37.900552 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:43.546271 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 5.644 seconds
[0m16:11:43.557382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:43.558349 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m16:11:43.559658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:43.563891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:43.564793 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m16:11:43.566384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:43.597425 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m16:11:43.598430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:43.599224 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m16:11:43.872541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.272 seconds
[0m16:11:43.886024 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m16:11:43.900980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:11:43.902163 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m16:11:43.991980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.089 seconds
[0m16:11:43.995723 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m16:11:43.998304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0adb22e060>]}
[0m16:11:43.999657 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 144391[0m in 6.41s]
[0m16:11:44.000939 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m16:11:44.001872 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m16:11:44.003106 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m16:11:44.004399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m16:11:44.005650 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m16:11:44.010977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m16:11:44.020818 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m16:11:44.026239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m16:11:44.037800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:11:44.039129 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m16:11:44.040081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:44.045451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:11:44.046603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:11:44.048066 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:46.226928 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 2.178 seconds
[0m16:11:46.231723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:11:46.232706 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m16:11:46.233997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:46.238776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:11:46.239730 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m16:11:46.240988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:46.243759 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m16:11:46.244742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:11:46.245727 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m16:11:46.459230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.213 seconds
[0m16:11:46.464488 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m16:11:46.466170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:11:46.467036 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m16:11:46.539037 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.071 seconds
[0m16:11:46.541312 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m16:11:46.542865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad6cb00e0>]}
[0m16:11:46.544530 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 144391[0m in 2.54s]
[0m16:11:46.546792 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m16:11:46.548727 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m16:11:46.550948 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m16:11:46.552440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m16:11:46.554380 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m16:11:46.562853 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m16:11:46.594679 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m16:11:46.602979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m16:11:46.610174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:11:46.610955 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m16:11:46.611641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:46.616129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:11:46.617384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:11:46.618625 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:52.420385 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 5.801 seconds
[0m16:11:52.426877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:11:52.427874 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m16:11:52.429545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:52.437983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:11:52.439265 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m16:11:52.440605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:52.444259 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m16:11:52.445155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:11:52.446008 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m16:11:52.608537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.161 seconds
[0m16:11:52.612799 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m16:11:52.614812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:11:52.615877 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m16:11:52.656414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m16:11:52.658738 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m16:11:52.660341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad6c38410>]}
[0m16:11:52.662228 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 144391[0m in 6.11s]
[0m16:11:52.663987 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m16:11:52.665484 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m16:11:52.666728 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m16:11:52.667800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m16:11:52.669530 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m16:11:52.677138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m16:11:52.684478 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m16:11:52.692279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m16:11:52.701764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:11:52.702601 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m16:11:52.703462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:52.708289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:11:52.709736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:11:52.710682 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:11:55.831638 [debug] [Thread-1 (]: SQL status: SELECT 144391 in 3.120 seconds
[0m16:11:55.840380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:11:55.841563 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m16:11:55.844196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:55.852136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:11:55.853288 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m16:11:55.854731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:55.858564 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m16:11:55.859919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:11:55.861728 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m16:11:56.036160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.172 seconds
[0m16:11:56.040096 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m16:11:56.041548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:11:56.042474 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m16:11:56.115863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.072 seconds
[0m16:11:56.119167 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m16:11:56.122076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87aa5807-1d22-4d0b-b257-73d0a0e9d8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad81a1d90>]}
[0m16:11:56.124199 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 144391[0m in 3.45s]
[0m16:11:56.126696 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m16:11:56.131644 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:56.133200 [debug] [MainThread]: On master: BEGIN
[0m16:11:56.134457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:56.145648 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:11:56.147269 [debug] [MainThread]: On master: COMMIT
[0m16:11:56.148553 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:56.149566 [debug] [MainThread]: On master: COMMIT
[0m16:11:56.150985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:56.151984 [debug] [MainThread]: On master: Close
[0m16:11:56.153259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:56.156866 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m16:11:56.159385 [info ] [MainThread]: 
[0m16:11:56.163144 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 18.75 seconds (18.75s).
[0m16:11:56.169615 [debug] [MainThread]: Command end result
[0m16:11:56.381496 [info ] [MainThread]: 
[0m16:11:56.383366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:56.385251 [info ] [MainThread]: 
[0m16:11:56.387073 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:11:56.392491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.96301, "process_user_time": 3.941501, "process_kernel_time": 0.161702, "process_mem_max_rss": "122536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:11:56.400164 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:56.399830 after 19.97 seconds
[0m16:11:56.402101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0adc4ffc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad913d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad6c309e0>]}
[0m16:11:56.403492 [debug] [MainThread]: Flushing usage events
[0m16:34:29.202518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445bd8a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445bfb6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445b97cb00>]}


============================== 16:34:29.289110 | 94bc54f9-4d91-4c66-a7d4-669b6d642559 ==============================
[0m16:34:29.289110 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:34:29.290255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:34:29.609898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445b0b0290>]}
[0m16:34:29.706134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445b0664e0>]}
[0m16:34:29.707583 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:34:29.888107 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:34:30.267616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:30.268369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:30.330108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445a500da0>]}
[0m16:34:30.525080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445a5c6840>]}
[0m16:34:30.526247 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m16:34:30.527891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44599727b0>]}
[0m16:34:30.531831 [info ] [MainThread]: 
[0m16:34:30.533481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:30.542531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:34:30.636193 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:34:30.637056 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:34:30.637796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:30.645121 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m16:34:30.647996 [debug] [ThreadPool]: On list_airflow: Close
[0m16:34:30.652033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m16:34:30.661138 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:34:30.662268 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m16:34:30.663127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:30.668686 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:34:30.670098 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:34:30.671370 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m16:34:30.685727 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m16:34:30.688581 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m16:34:30.689976 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m16:34:30.691614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m16:34:30.699438 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:34:30.700611 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m16:34:30.701394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:30.705903 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:34:30.707125 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:34:30.708246 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m16:34:30.713859 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m16:34:30.716310 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m16:34:30.717294 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m16:34:30.727442 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:30.728583 [debug] [MainThread]: On master: BEGIN
[0m16:34:30.729286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:30.733489 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:34:30.734681 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:30.735723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:30.743504 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:30.746959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445b085e80>]}
[0m16:34:30.748245 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:30.749328 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:30.750067 [debug] [MainThread]: On master: BEGIN
[0m16:34:30.751186 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:34:30.752799 [debug] [MainThread]: On master: COMMIT
[0m16:34:30.753599 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:30.754269 [debug] [MainThread]: On master: COMMIT
[0m16:34:30.755312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:30.756290 [debug] [MainThread]: On master: Close
[0m16:34:30.757475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:30.758322 [info ] [MainThread]: 
[0m16:34:30.774791 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m16:34:30.776578 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m16:34:30.777924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.staging_dim_address)
[0m16:34:30.778806 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m16:34:30.790515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m16:34:30.799595 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m16:34:30.878515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m16:34:30.884366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:34:30.885299 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m16:34:30.886009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:30.890066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:30.891500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:34:30.892543 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)
SELECT
    *
FROM
    source_data
  );
  
[0m16:34:32.504205 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 1.611 seconds
[0m16:34:32.512396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:34:32.513431 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m16:34:32.515987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:34:32.520106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:34:32.520945 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m16:34:32.522115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:32.549151 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m16:34:32.550289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:34:32.551264 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m16:34:32.889295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.337 seconds
[0m16:34:32.897940 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m16:34:32.904217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m16:34:32.905076 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m16:34:32.947873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.042 seconds
[0m16:34:32.952816 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m16:34:32.956092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445ca556d0>]}
[0m16:34:32.957847 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 152294[0m in 2.18s]
[0m16:34:32.960848 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m16:34:32.962189 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m16:34:32.963416 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m16:34:32.964491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m16:34:32.965550 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m16:34:32.971891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m16:34:32.981518 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m16:34:32.986662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m16:34:32.995528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:34:32.996500 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m16:34:32.997347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:33.001746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:33.003043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:34:33.003951 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:34:34.428089 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 1.423 seconds
[0m16:34:34.432656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:34:34.433507 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m16:34:34.434986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:34:34.439727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:34:34.440838 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:34:34.442229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:34.445007 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m16:34:34.445845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:34:34.446658 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m16:34:34.566809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.119 seconds
[0m16:34:34.570492 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m16:34:34.571807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m16:34:34.572630 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m16:34:34.619373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.046 seconds
[0m16:34:34.621546 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m16:34:34.622692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44585de330>]}
[0m16:34:34.624128 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 152294[0m in 1.66s]
[0m16:34:34.625508 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m16:34:34.626501 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:34:34.627520 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m16:34:34.628521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_fact_network_usage)
[0m16:34:34.629367 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:34:34.633757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:34.641688 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:34:34.648038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:34.656026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:34.657121 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: BEGIN
[0m16:34:34.657967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:34.661945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:34.662884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:34.663780 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:34:35.734392 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 1.070 seconds
[0m16:34:35.738591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:35.739395 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m16:34:35.740531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:35.744446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:35.745257 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m16:34:35.746332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:35.749299 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: COMMIT
[0m16:34:35.750287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:35.751051 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: COMMIT
[0m16:34:35.895184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.143 seconds
[0m16:34:35.898814 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m16:34:35.900181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_fact_network_usage"
[0m16:34:35.901033 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m16:34:35.976310 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.074 seconds
[0m16:34:35.978392 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_fact_network_usage: Close
[0m16:34:35.979441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4458338e30>]}
[0m16:34:35.980531 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 152294[0m in 1.35s]
[0m16:34:35.981732 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_fact_network_usage
[0m16:34:35.982773 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m16:34:35.983847 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m16:34:35.985110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_fact_network_usage, now model.dbt_driven_data.staging_dim_finance)
[0m16:34:35.986033 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m16:34:35.990336 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m16:34:35.999134 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m16:34:36.004272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m16:34:36.012365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:34:36.013164 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m16:34:36.013874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:36.017869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:36.018926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:34:36.019654 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:34:36.913920 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 0.894 seconds
[0m16:34:36.918217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:34:36.919055 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m16:34:36.920511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:34:36.924473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:34:36.925254 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m16:34:36.926487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:36.929050 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m16:34:36.929925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:34:36.930789 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m16:34:36.974717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m16:34:36.978405 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m16:34:36.979792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m16:34:36.980645 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m16:34:37.053974 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.072 seconds
[0m16:34:37.056120 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m16:34:37.057173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44585c9e50>]}
[0m16:34:37.059186 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 152294[0m in 1.07s]
[0m16:34:37.060278 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m16:34:37.061205 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m16:34:37.062211 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m16:34:37.063365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m16:34:37.064217 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m16:34:37.068426 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m16:34:37.075684 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m16:34:37.080821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m16:34:37.088587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:34:37.089373 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m16:34:37.090038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:37.094027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:37.097043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:34:37.098045 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:34:38.448986 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 1.350 seconds
[0m16:34:38.455254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:34:38.456171 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m16:34:38.457528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:34:38.461654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:34:38.462546 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m16:34:38.463843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:38.466664 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m16:34:38.467537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:34:38.468388 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m16:34:38.592000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.123 seconds
[0m16:34:38.595642 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m16:34:38.596949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m16:34:38.597752 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m16:34:38.637975 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m16:34:38.640029 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m16:34:38.641078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94bc54f9-4d91-4c66-a7d4-669b6d642559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445830fcb0>]}
[0m16:34:38.642209 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 152294[0m in 1.58s]
[0m16:34:38.643376 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m16:34:38.646157 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:38.647021 [debug] [MainThread]: On master: BEGIN
[0m16:34:38.648100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:38.652776 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:34:38.654065 [debug] [MainThread]: On master: COMMIT
[0m16:34:38.654903 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:38.655698 [debug] [MainThread]: On master: COMMIT
[0m16:34:38.656817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:38.657572 [debug] [MainThread]: On master: Close
[0m16:34:38.658525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:38.659191 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_dim_person' was properly closed.
[0m16:34:38.660168 [info ] [MainThread]: 
[0m16:34:38.661033 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m16:34:38.663489 [debug] [MainThread]: Command end result
[0m16:34:38.727649 [info ] [MainThread]: 
[0m16:34:38.728583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:38.729508 [info ] [MainThread]: 
[0m16:34:38.730300 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:34:38.731838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.62303, "process_user_time": 4.222248, "process_kernel_time": 0.555559, "process_mem_max_rss": "122792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:38.732913 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:38.732769 after 9.62 seconds
[0m16:34:38.733854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445bfb6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445b898dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445bce2bd0>]}
[0m16:34:38.734665 [debug] [MainThread]: Flushing usage events
[0m16:34:44.584581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302b2ccd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302b1eef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302af92780>]}


============================== 16:34:44.591332 | 0176caaf-3c29-47bb-97e2-2e9cae0349c0 ==============================
[0m16:34:44.591332 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:34:44.592401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:44.821088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302bea1d00>]}
[0m16:34:44.891820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302be52c00>]}
[0m16:34:44.893074 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:34:45.028658 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:34:45.268513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:45.269256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:45.315197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3029f603e0>]}
[0m16:34:45.472240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3029b99ac0>]}
[0m16:34:45.473185 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m16:34:45.474075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302bb8a660>]}
[0m16:34:45.476717 [info ] [MainThread]: 
[0m16:34:45.478030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:45.484915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:34:45.545070 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:34:45.546292 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:34:45.547546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:45.555363 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m16:34:45.557942 [debug] [ThreadPool]: On list_airflow: Close
[0m16:34:45.561202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m16:34:45.574924 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:34:45.576153 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m16:34:45.576773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:45.581580 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:34:45.582632 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m16:34:45.583348 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m16:34:45.587937 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m16:34:45.590509 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m16:34:45.591677 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m16:34:45.593044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m16:34:45.599468 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:34:45.600630 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m16:34:45.601511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:45.606352 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:34:45.607534 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m16:34:45.608605 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m16:34:45.614477 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m16:34:45.617723 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m16:34:45.618870 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m16:34:45.630777 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:45.632020 [debug] [MainThread]: On master: BEGIN
[0m16:34:45.632921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:45.637983 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:34:45.639532 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:45.640780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:45.647729 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m16:34:45.650507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3028bc5fd0>]}
[0m16:34:45.651455 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:45.652552 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:45.653346 [debug] [MainThread]: On master: BEGIN
[0m16:34:45.654414 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:34:45.655702 [debug] [MainThread]: On master: COMMIT
[0m16:34:45.656431 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:45.657246 [debug] [MainThread]: On master: COMMIT
[0m16:34:45.658333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:45.659217 [debug] [MainThread]: On master: Close
[0m16:34:45.660548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:45.661581 [info ] [MainThread]: 
[0m16:34:45.681999 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m16:34:45.683026 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m16:34:45.683892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.trusted_non_pii_data)
[0m16:34:45.684517 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m16:34:45.697770 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:45.702255 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m16:34:45.760200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:45.766059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:45.766860 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m16:34:45.767521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:45.771899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:45.773171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:45.774137 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:34:51.076678 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 5.303 seconds
[0m16:34:51.084789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:51.085637 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m16:34:51.086900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:51.091136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:51.092071 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m16:34:51.093320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:51.126709 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m16:34:51.127801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:51.128652 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m16:34:51.170917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m16:34:51.179554 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m16:34:51.186057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m16:34:51.186951 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m16:34:51.230510 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.043 seconds
[0m16:34:51.233862 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m16:34:51.235859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3027e702f0>]}
[0m16:34:51.236986 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 152294[0m in 5.55s]
[0m16:34:51.238147 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m16:34:51.239121 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m16:34:51.240227 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m16:34:51.241267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m16:34:51.242308 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m16:34:51.249855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m16:34:51.257942 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m16:34:51.263525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m16:34:51.270947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:34:51.271802 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m16:34:51.286546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:51.291011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:51.292281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:34:51.293309 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:34:53.080597 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 1.786 seconds
[0m16:34:53.085062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:34:53.085878 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m16:34:53.087204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:34:53.091275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:34:53.092137 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m16:34:53.093297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:53.095999 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m16:34:53.096816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:34:53.097639 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m16:34:53.292337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.194 seconds
[0m16:34:53.296235 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m16:34:53.297613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m16:34:53.298478 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m16:34:53.330851 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m16:34:53.332951 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m16:34:53.334037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3027fd6420>]}
[0m16:34:53.335306 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 152294[0m in 2.09s]
[0m16:34:53.336569 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m16:34:53.337572 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m16:34:53.338735 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m16:34:53.340194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m16:34:53.341212 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m16:34:53.348547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m16:34:53.356179 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m16:34:53.362337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m16:34:53.369640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:34:53.370355 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m16:34:53.371073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:53.375420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:53.376601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:34:53.377519 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."driven_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."driven_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:34:58.442575 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 5.064 seconds
[0m16:34:58.447142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:34:58.447964 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m16:34:58.449170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:58.454438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:34:58.455451 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m16:34:58.456665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:34:58.459721 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m16:34:58.460526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:34:58.461281 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m16:34:58.596087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.134 seconds
[0m16:34:58.599899 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m16:34:58.601738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m16:34:58.603123 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m16:34:58.683007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.079 seconds
[0m16:34:58.686639 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m16:34:58.688876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3026521250>]}
[0m16:34:58.690080 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 152294[0m in 5.35s]
[0m16:34:58.691149 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m16:34:58.692009 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m16:34:58.692953 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m16:34:58.693896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m16:34:58.694872 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m16:34:58.700116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m16:34:58.708787 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m16:34:58.713931 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m16:34:58.722152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:34:58.722931 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m16:34:58.723601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:58.727432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:34:58.728533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:34:58.729544 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."driven_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."driven_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:35:00.358465 [debug] [Thread-1 (]: SQL status: SELECT 152294 in 1.628 seconds
[0m16:35:00.363145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:35:00.364090 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m16:35:00.365288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:35:00.370556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:35:00.371500 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m16:35:00.372826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:00.375519 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m16:35:00.376312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:35:00.377130 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m16:35:00.548886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.171 seconds
[0m16:35:00.554653 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m16:35:00.556190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m16:35:00.557093 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m16:35:00.589631 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m16:35:00.591964 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m16:35:00.592998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0176caaf-3c29-47bb-97e2-2e9cae0349c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302652a6f0>]}
[0m16:35:00.594483 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 152294[0m in 1.90s]
[0m16:35:00.595553 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m16:35:00.598602 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:00.599576 [debug] [MainThread]: On master: BEGIN
[0m16:35:00.601700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:00.606599 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:35:00.607774 [debug] [MainThread]: On master: COMMIT
[0m16:35:00.608731 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:00.609398 [debug] [MainThread]: On master: COMMIT
[0m16:35:00.610285 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:00.611101 [debug] [MainThread]: On master: Close
[0m16:35:00.611983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:00.612720 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m16:35:00.613656 [info ] [MainThread]: 
[0m16:35:00.614569 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.14 seconds (15.14s).
[0m16:35:00.617197 [debug] [MainThread]: Command end result
[0m16:35:00.692299 [info ] [MainThread]: 
[0m16:35:00.693468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:00.694388 [info ] [MainThread]: 
[0m16:35:00.695228 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:35:00.696751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.181736, "process_user_time": 3.353523, "process_kernel_time": 0.240971, "process_mem_max_rss": "122612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:00.697901 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:00.697744 after 16.18 seconds
[0m16:35:00.698954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302b38b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302b1c2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3027e80680>]}
[0m16:35:00.702341 [debug] [MainThread]: Flushing usage events
